@page "/"
@using LawyerServices.Common.AministrationViewModels
@using LawyerServices.Common.AreasOfActivityViewModels
@using LawyerServices.Common.LawyerViewModels
@using LawyerServices.Services.Data
@using LawyerServices.Services.Data.AdminServices
@using LawyerServices.Services.Data.AdminServices.AreasOfActivityServices

@inject ITownService townService
@inject ILawyerService lawyerService
@inject IAreasOfActivityService areaService

<PageTitle>Index</PageTitle>
<div class="layer home-layer">
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-sm-8 col-md-6 col-xl-4">
                <h1>Намерете адвокат и резервирайте час за консултация онлайн!</h1>
                <div id="search-doctor">
                    <h4>Търси адвокат</h4>
                    <div>
                        <RadzenDropDown AllowClear="true" TValue="string" Placeholder="Изберете град" Class="w-100"
                                        Data=@(towns.Select(c => c.Name).Distinct())
                                        Change=@(args => OnChange(args, "DropDown")) />
                        <RadzenDropDown AllowClear="true" TValue="string" Placeholder="Изберете сфера на дейност" Class="w-100"
                                        Data=@(areas.Select(c => c.Name).Distinct())
                                        Change=@(args => OnChangeArea(args, "DropDown")) />
                    </div>
                    <button type="button" @onclick="Submit" class="btn btn-outline-primary btn-sm">Primary</button>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row justify-content-end">
                    <div class="col-xl-6">
                        <div class="home-hero">
                            <img class="img-fluid" src="/images/justice.png" asp-append-version="true">
                        </div>
                    </div>
                    <div class="col-xl-5">
                        <div class="home-description">
                            <h2 class="heading-4">Какво е Супердок?</h2>
                            <p>
                                Супердок Ви помага да намерите различни специалисти, да прочетете мнения на други пациенти и да резервирате час за преглед онлайн – в удобно за Вас време и място.
                                <a href="https://superdoc.bg/za-nas">Научи повече</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*<div class="container-fluid mt-lg-5 shadow p-3 mb-5 bg-white">
    <h1>Hello, world!</h1>
    <div class="row px-3">

    <div class="col-md-6 col-lg-4 col-xl-3 p-3">
    <RadzenDropDown AllowClear="true" TValue="string" Class="w-100"
    Data=@(towns.Select(c => c.Name).Distinct())
    Change=@(args => OnChange(args, "DropDown")) />
    </div>
    <div class="col-md-6 col-lg-4 col-xl-3 p-3">
    <RadzenDropDown AllowClear="true" TValue="string" Class="w-100"
    Data=@(areas.Select(c => c.Name).Distinct())
    Change=@(args => OnChangeArea(args, "DropDown")) />
    </div>
    <button type="button" @onclick="Submit" class="btn btn-primary">Primary</button>
    </div>

    </div>
    <div class="container-fluid mt-lg-5 shadow p-3 mb-5 bg-white">
    <h1>Hello, world!</h1>
    <div class="row px-3">

    <div class="col-md-6 col-lg-4 col-xl-3 p-3">
    <RadzenDropDown AllowClear="true" TValue="string" Class="w-100"
    Data=@(towns.Select(c => c.Name).Distinct())
    Change=@(args => OnChange(args, "DropDown")) />
    </div>
    <div class="col-md-6 col-lg-4 col-xl-3 p-3">
    <RadzenDropDown AllowClear="true" TValue="string" Class="w-100"
    Data=@(areas.Select(c => c.Name).Distinct())
    Change=@(args => OnChangeArea(args, "DropDown")) />
    </div>
    <button type="button" @onclick="Submit" class="btn btn-primary btn-lg">Търси</button>
    </div>

    </div>*@
<section id="features" class="padd-section text-center">

    <div class="container" data-aos="fade-up">
        <div class="section-title text-center">
            <h2>Популярни сфери в правото</h2>
        </div>

        <div class="row" data-aos="fade-up" data-aos-delay="100">

            <div class="col-md-6 col-lg-3" @onclick="@(() => OnClick("авторско право"))">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>Авторско право</h4>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>creative design</h4>
                    
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>Retina Ready</h4>
                   
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>easy to use</h4>
                   
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>Free Updates</h4>
                   
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>Free Updates</h4>
                   
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>App store support</h4>
                   
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>Perfect Pixel</h4>
                    
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="feature-block">
                    <img src="/images/asp.jpg" alt="img">
                    <h4>clean codes</h4>
                    
                </div>
            </div>

        </div>
    </div>
</section><!-- End Features Section -->
<style>
    .home-layer #home-search #search-doctor {
        display: block;
        -webkit-animation-name: fadeIn;
        animation-name: fadeIn;
        -webkit-animation-duration: .5s;
        animation-duration: .5s;
        -webkit-animation-fill-mode: both;
        animation-fill-mode: both;
    }

    :after, :before {
        box-sizing: border-box;
    }

    .home-layer {
        padding-top: 0;
    }

    .layer {
        padding-top: 80px;
        padding-bottom: 80px;
    }

    :after, :before {
        box-sizing: border-box;
    }

    .footer, .header, .home-layer, .layer {
        max-width: 1680px;
        margin: 0 auto;
    }
    /* Features Section
    --------------------------------*/
    /*#features {
      display: inline-block;
      height: 100%;
      width: 100%;
    }*/
    #features .feature-block {
        background: #fff none repeat scroll 0 0;
        padding: 30px 20px;
        margin-bottom: 30px;
        transition: all 0.5s ease-in-out 0s;
    }

        #features .feature-block img {
            height: 60px;
            margin-bottom: 30px;
            width: 60px;
        }

        #features .feature-block:hover {
            box-shadow: 0 0 35px rgba(0, 0, 0, 0.3);
            transition: all 0.5s ease-in-out 0s;
        }

        #features .feature-block h4 {
            margin-bottom: 20px;
        }

        #features .feature-block p {
            margin-bottom: 0;
        }

    .padd-section {
        padding-bottom: 80px;
        padding-top: 80px;
    }
</style>

@code {

    private IEnumerable<TownViewModel> towns;
    string? townName;
    string? areaName;

    private IEnumerable<AreasOfActivityViewModel> areas;

    protected override void OnInitialized()
    {

        this.areas = this.areaService.GetAll<AreasOfActivityViewModel>();
        this.towns = this.townService.GetAll<TownViewModel>();
    }
    private void OnClick(string name)
    {
        var a = areas.First(x => x.Name == "Наказателно право").Name.ToString();
        this.NavigationManager.NavigateTo($"lawyers/{townName}/{name}");

    
    }
    private void HandleValidSubmit()
    {
        //this.NavigationManager.NavigateTo($"lawyers/{townId}");
        // Process the valid form
    }
    void OnChange(object value, string name)
    {
        var town = towns.FirstOrDefault(t => t.Name == value?.ToString());
        if (town != null)
        {
            townName = town.Name;
        }

        //this.NavigationManager.NavigateTo($"lawyers/{town?.Id}");

    }
    void OnChangeArea(object value, string name)
    {
        var area = areas.FirstOrDefault(a => a.Name == value?.ToString());
        areaName = area.Name;
    }
    void Submit()
    {

        this.NavigationManager.NavigateTo($"lawyers/{townName}/{areaName}");
    }
}